<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/aspirematch.png') }}">
    <link href="{{ url_for('static', filename='css/output.css') }}" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="flex flex-col min-h-screen bg-[#f6ebcd] overflow-x-hidden">

{% include 'components/studentHeader.html' %}

{% include 'components/studentSidebar.html' %}

<!-- MAIN CONTENT WRAPPER -->
<div class="flex flex-1 w-500px">
    <main
        class="
            flex-1
            bg-[#f6ebcd]
            min-h-screen
            pt-[110px]
            px-4 sm:px-6 lg:px-8
            sm:w-200px
            lg:ml-72
        "
    >

        <!-- TASK TABLE -->
        <div class="bg-white rounded-2xl border border-[#166D3B] text-xs lg:text-sm mb-6 overflow-x-auto">
            <table class="w-full table-fixed">
                <thead class="bg-[#166D3B] text-white">
                    <tr>
                        <th class="p-3 text-center">Task</th>
                        <th class="p-3 text-center">Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="border-r p-3 text-center">
                            Career Interest Survey
                        </td>
                        <td class="text-[#166D3B] font-semibold p-3 text-left">
                            {{ student_survey_answer_completed }}
                        </td>
                    </tr>

                    <tr>
                        <td class="border-r p-3 text-center">
                            Preferred and Recommended Program
                        </td>
                        <td class="p-3 text-left
                            {% if match_status == '❌ Not Match' %}
                                text-red-500
                            {% elif match_status == '✅ Match' %}
                                text-[#166D3B] font-semibold
                            {% else %}
                                text-black
                            {% endif %}
                        ">
                            {{ match_status }}
                        </td>
                    </tr>

                    <tr>
                        <td class="border-r p-3 text-center">
                            Interview Date
                        </td>
                        <td class="p-3 text-left">
                            {% if interview_status == "add_date" %}
                                <a href="{{ url_for('student.choose_schedule') }}"
                                   class="inline-block px-4 py-2 bg-[#166D3B] text-white rounded-lg hover:bg-green-700 transition">
                                    Add Date
                                </a>
                            {% else %}
                                <span class="font-semibold text-[#166D3B]">
                                    {{ interview_status }}
                                </span>
                            {% endif %}
                        </td>
                    </tr>

                    {% if interview_status and interview_status != "add_date" %}
                    <tr>
                        <td class="border-r p-3 text-center">
                            Inventory Form
                        </td>
                        <td class="p-3 text-left">
                            {% if inventory_status == "not_completed" %}
                                <a href="{{ url_for('student.studentInventory') }}"
                                   class="inline-block px-6 py-2 bg-[#166D3B] text-white rounded hover:bg-green-700">
                                    Answer
                                </a>
                            {% else %}
                                <span class="text-[#166D3B] font-semibold">
                                    Completed
                                </span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endif %}
                </tbody>
            </table>
        </div>

        <!-- STATUS MESSAGE BOX -->
        <div class="bg-white rounded-2xl border border-[#166D3B] p-4 text-center text-xs lg:text-sm">
            {% if match_status == "❌ Not Match" and interview_status == "add_date" %}
                <p class="text-red-600">Your Preferred program and your top chosen letter does not match.</p>
                <p class="text-red-600 mt-2">Please click <strong>Add Date</strong> to schedule your interview.</p>
                <p class="text-red-600 mt-2">The venue is Guidance office.</p>
            {% endif %}

            {% if match_status == "✅ Match" and inventory_status == "not_completed" %}
                <p class="text-green-600">
                    You are qualified to enroll in
                    <strong>{{ student_results.preferred_program }}</strong>.
                </p>
                <p class="text-red-600 mt-2">Also answer inventory form.</p>
            {% endif %}
            {% if student_survey_answer_completed == "✅ Completed" and inventory_status == "completed"  %}
                <p class="text-green-600">
                    You can download your result in Career Interest Survey and Inventory
                </p>
                <p class="text-green-600 mt-2">
                    Just click RESULT
                </p>
            {% endif %}
        </div>

    </main>
</div>

<script>
function updateNotifBadge() {
    fetch("/student/notification_count")
        .then(res => res.json())
        .then(data => {
            const badge = document.getElementById("notifBadge");
            if (data.count > 0) {
                badge.innerText = data.count;
                badge.classList.remove("hidden");
            } else {
                badge.classList.add("hidden");
            }
        });
}

updateNotifBadge();

setInterval(updateNotifBadge, 10000);
</script>

    {% include 'components/footer.html' %}

</body>
</html>
